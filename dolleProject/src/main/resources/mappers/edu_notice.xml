<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.edu.noticeBoard">

	<resultMap type="com.edu.noticeBoard.vo.NoticeVo" 
		id="noticeResultMap">
		<id column="NOTICE_IDX" 			property="noticeIdx"/>
		<result column="MEMBER_IDX" 		property="noticeMemberIdx"/>
		<result column="NOTICE_TITLE" 		property="noticeTitle"/>
		<result column="NOTICE_CONTENT" 	property="noticeContent"/>
		<result column="NOTICE_CRE_DATE" 	property="noticeCreDate"
			javaType="java.util.Date"/>
		<result column="NOTICE_MOD_DATE" 	property="noticeModDate"
			javaType="java.util.Date"/>
		<result column="NOTICE_FIXED" 		property="noticeFixed"/>
		<result column="NOTICE_DEL_FLAG" 	property="noticeDelYn"/>
	</resultMap>
	
	<resultMap type="com.edu.noticeBoard.vo.NoticeMemberFileVo"
		id="noticeMemberFileResultMap">
		<id 	column="NOTICE_IDX"			property="noticeIdx"/>
		<result column="MEMBER_IDX" 		property="memberIdx"/>
		<result column="NOTICE_TITLE" 		property="noticeTitle"/>
		<result column="NOTICE_CRE_DATE" 	property="noticeCreDate"
			javaType="java.util.Date"/>
		<result column="NOITCE_FIXED"		property="noticeFixed"/>
			
		<result column="MEMBER_NICKNAME" 	property="memberNickname"/>
		
		<result column="FILE_EXIST"			property="fileExist"/>
	</resultMap>
	
	<select id="noticeMemberFileList" parameterType="map"
		resultMap="noticeMemberFileResultMap">
		SELECT NB.NOTICE_IDX, NB.NOTICE_TITLE, NB.NOTICE_CRE_DATE, M.MEMBER_NICKNAME, NVL2(NF.NOTICE_IDX, 1, 0) AS FILE_EXIST
		FROM NOTICEBOARD NB, MEMBER M, NOTICE_FILE NF
		WHERE NB.MEMBER_IDX = M.MEMBER_IDX
		AND NB.NOTICE_IDX = NF.NOTICE_IDX(+)
		ORDER BY NB.NOTICE_IDX DESC
	</select>
	
	<select id="noticeMemberFileFixedList" parameterType="map"
		resultMap="noticeMemberFileResultMap">
		SELECT NB.NOTICE_IDX, NB.NOTICE_TITLE, NB.NOTICE_CRE_DATE, M.MEMBER_NICKNAME, NVL2(NF.NOTICE_IDX, 1, 0) AS FILE_EXIST
		FROM NOTICEBOARD NB, MEMBER M, NOTICE_FILE NF
		WHERE NB.MEMBER_IDX = M.MEMBER_IDX
		AND NB.NOTICE_IDX = NF.NOTICE_IDX(+)
		AND NB.NOTICE_FIXED = 'fixed'
		ORDER BY NB.NOTICE_IDX DESC
	</select>
	
	
</mapper>